id:ID,:Definition,text
definition0001,,Requirements: application error logs must be collected (with LOG_LEVEL ERROR and above)
definition0002,,Requirements: application error logs must be collected (with LOG_LEVEL=ERROR and above)
definition0003,,"Requirements: install and apply the RPC Firewall to all processes with ""audit:true action:block uuid:4b324fc8-1670-01d3-1278-5a47bf6ee188 opnum:12"
definition0004,,"Requirements: install and apply the RPC Firewall to all processes with ""audit:true action:block uuid:367abb81-9844-35f1-ad32-98f038001003"
definition0005,,"Requirements: install and apply the RPC Firewall to all processes, enable DRSR UUID (e3514235-4b06-11d1-ab04-00c04fc2dcd2) for ""dangerous"" opcodes (not 0,1 or 12) only from trusted IPs (DCs)"
definition0006,,"Requirements: install and apply the RPC Firewall to all processes with ""audit:true action:block uuid:6bffd098-a112-3610-9833-46c3f87e345a opnum:2"
definition0007,,"Requirements: install and apply the RPC Firewall to all processes with ""audit:true action:block uuid:86d35949-83c9-4044-b424-db363231fd0c"""
definition0008,,"Requirements: install and apply the RPC Firewall to all processes with ""audit:true action:block uuid:1ff70682-0a51-30e8-076d-740be8cee98b"""
definition0009,,"Requirements: install and apply the RPC Firewall to all processes with ""audit:true action:block uuid:378e52b0-c0a9-11cf-822d-00aa0051e40f"""
definition0010,,"Requirements: install and apply the RPC Firewall to all processes with ""audit:true action:block uuid:12345678-1234-abcd-ef00-0123456789ab or 76f03f96-cdfd-44fc-a22c-64950a001209 or ae33069b-a2a8-46ee-a235-ddfd339be281 or 0b6edbfa-4a24-4fc6-8a23-942b1eca65d1"
definition0011,,"Requirements: install and apply the RPC Firewall to all processes with ""audit:true action:block uuid:367abb81-9844-35f1-ad32-98f038001003"
definition0012,,"Requirements: install and apply the RPC Firewall to all processes with ""audit:true action:block uuid:df1941c5-fe89-4e79-bf10-463657acf44d or c681d488-d850-11d0-8c52-00c04fd90f7e"
definition0013,,"Requirements: install and apply the RPC Firewall to all processes with ""audit:true action:block uuid:86d35949-83c9-4044-b424-db363231fd0c"""
definition0014,,"Requirements: install and apply the RPC Firewall to all processes with ""audit:true action:block uuid:378e52b0-c0a9-11cf-822d-00aa0051e40f"""
definition0015,,"Requirements: install and apply the RPC Firewall to all processes with ""audit:true action:block uuid:1ff70682-0a51-30e8-076d-740be8cee98b"""
definition0016,,"Requirements: install and apply the RPC Firewall to all processes with ""audit:true action:block uuid:4b324fc8-1670-01d3-1278-5a47bf6ee188"
definition0017,,"Requirements: install and apply the RPC Firewall to all processes with ""audit:true action:block uuid:338cd001-2244-31f1-aaaa-900038001003"""
definition0018,,"Requirements: install and apply the RPC Firewall to all processes with ""audit:true action:block uuid:338cd001-2244-31f1-aaaa-900038001003"""
definition0019,,"Requirements: install and apply the RPC Firewall to all processes with ""audit:true action:block uuid:82273fdc-e32a-18c3-3f78-827929dc23ea and uuid:f6beaff7-1e19-4fbb-9f8f-b89e2018337c"""
definition0020,,Requirements: application error logs must be collected (with LOG_LEVEL=ERROR and above)
definition0021,,Requirements: application error logs must be collected (with LOG_LEVEL=ERROR and above)
definition0022,,Requirements: application error logs must be collected (with LOG_LEVEL=ERROR and above)
definition0023,,Requirements: application error logs must be collected (with LOG_LEVEL=ERROR and above)
definition0024,,Requirements: application error logs must be collected (with LOG_LEVEL=ERROR and above)
definition0025,,Requirements: application error logs must be collected (with LOG_LEVEL=ERROR and above)
definition0026,,Requirements: application error logs must be collected (with LOG_LEVEL=ERROR and above)
definition0027,,Requirements: The TargetResources array needs to be mapped accurately in order for this rule to work
definition0028,,"Requirements: ""Advance"" log level is required to receive these audit events."
definition0029,,"Requirements: ""Advance"" log level is required to receive these audit events."
definition0030,,"Requirements: ""Basic"" log level is required to receive these audit events."
definition0031,,"Requirements: ""Advance"" log level is required to receive these audit events."
definition0032,,"Requirements: ""Advance"" log level is required to receive these audit events."
definition0033,,"Requirements: ""Advance"" log level is required to receive these audit events."
definition0034,,"Requirements: ""Advance"" log level is required to receive these audit events."
definition0035,,"Requirements: ""Advance"" log level is required to receive these audit events."
definition0036,,"Requirements: ""Advance"" log level is required to receive these audit events."
definition0037,,"Requirements: ""Basic"" log level is required to receive these audit events."
definition0038,,"Requirements: ""Advance"" log level is required to receive these audit events."
definition0039,,"Requirements: ""Basic"" log level is required to receive these audit events."
definition0040,,Requirements: The audit log streaming feature must be enabled to be able to receive such logs. You can enable following the documentation here: https://docs.github.com/en/enterprise-cloud@latest/admin/monitoring-activity-in-your-enterprise/reviewing-audit-logs-for-your-enterprise/streaming-the-audit-log-for-your-enterprise#setting-up-audit-log-streaming
definition0041,,Requirements: The audit log streaming feature must be enabled to be able to receive such logs. You can enable following the documentation here: https://docs.github.com/en/enterprise-cloud@latest/admin/monitoring-activity-in-your-enterprise/reviewing-audit-logs-for-your-enterprise/streaming-the-audit-log-for-your-enterprise#setting-up-audit-log-streaming
definition0042,,Requirements: The audit log streaming feature must be enabled to be able to receive such logs. You can enable following the documentation here: https://docs.github.com/en/enterprise-cloud@latest/admin/monitoring-activity-in-your-enterprise/reviewing-audit-logs-for-your-enterprise/streaming-the-audit-log-for-your-enterprise#setting-up-audit-log-streaming
definition0043,,Requirements: The audit log streaming feature must be enabled to be able to receive such logs. You can enable following the documentation here: https://docs.github.com/en/enterprise-cloud@latest/admin/monitoring-activity-in-your-enterprise/reviewing-audit-logs-for-your-enterprise/streaming-the-audit-log-for-your-enterprise#setting-up-audit-log-streaming
definition0044,,Requirements: The audit log streaming feature must be enabled to be able to receive such logs. You can enable following the documentation here: https://docs.github.com/en/enterprise-cloud@latest/admin/monitoring-activity-in-your-enterprise/reviewing-audit-logs-for-your-enterprise/streaming-the-audit-log-for-your-enterprise#setting-up-audit-log-streaming
definition0045,,Requirements: The audit log streaming feature must be enabled to be able to receive such logs. You can enable following the documentation here: https://docs.github.com/en/enterprise-cloud@latest/admin/monitoring-activity-in-your-enterprise/reviewing-audit-logs-for-your-enterprise/streaming-the-audit-log-for-your-enterprise#setting-up-audit-log-streaming
definition0046,,Requirements: The audit log streaming feature must be enabled to be able to receive such logs. You can enable following the documentation here: https://docs.github.com/en/enterprise-cloud@latest/admin/monitoring-activity-in-your-enterprise/reviewing-audit-logs-for-your-enterprise/streaming-the-audit-log-for-your-enterprise#setting-up-audit-log-streaming
definition0047,,Requirements: The audit log streaming feature must be enabled to be able to receive such logs. You can enable following the documentation here: https://docs.github.com/en/enterprise-cloud@latest/admin/monitoring-activity-in-your-enterprise/reviewing-audit-logs-for-your-enterprise/streaming-the-audit-log-for-your-enterprise#setting-up-audit-log-streaming
definition0048,,Requirements: The audit log streaming feature must be enabled to be able to receive such logs. You can enable following the documentation here: https://docs.github.com/en/enterprise-cloud@latest/admin/monitoring-activity-in-your-enterprise/reviewing-audit-logs-for-your-enterprise/streaming-the-audit-log-for-your-enterprise#setting-up-audit-log-streaming
definition0049,,Requires the 'eDiscovery search or exported' alert to be enabled
definition0050,,Requirements: Field enrichment is required for the filters to work. As field such as CommandLine and ParentImage are not available by default on this event type
definition0051,,Requirements: The CommandLine field enrichment is required in order for this rule to be used.
definition0052,,Requirements: Sysmon config with Imphash logging activated
definition0053,,Requirements: Sysmon or equivalent configured with Imphash logging
definition0054,,Requirements: Microsoft-Windows-LDAP-Client/Debug ETW logging
definition0055,,"Requirements: MSSQL audit policy to monitor for ""sp_procoption"" must be enabled in order to receive this event in the application log"
definition0056,,Requirements: MSSQL audit policy must be enabled in order to receive this event in the application log
definition0057,,Requirements: MSSQL audit policy must be enabled in order to receive this event (event id 33205)
definition0058,,Requirements: Must enable MSSQL authentication.
definition0059,,"Requirements: MSSQL audit policy to monitor for ""xp_cmdshell"" must be enabled in order to receive this event in the application log (Follow this tutorial https://dba.stackexchange.com/questions/103183/is-there-any-way-to-monitor-execution-of-xp-cmdshell-in-sql-server-2012)"
definition0060,,Requirements: MSSQL audit policy must be enabled in order to receive this event in the application log
definition0061,,Requirements: Microsoft-Windows-DNS Client Events/Operational Event Log must be enabled/collected in order to receive the events.
definition0062,,Requirements: Microsoft-Windows-DNS Client Events/Operational Event Log must be enabled/collected in order to receive the events.
definition0063,,Requirements: Microsoft-Windows-DNS Client Events/Operational Event Log must be enabled/collected in order to receive the events.
definition0064,,Requirements: Microsoft-Windows-DNS Client Events/Operational Event Log must be enabled/collected in order to receive the events.
definition0065,,Requirements: Microsoft-Windows-DNS Client Events/Operational Event Log must be enabled/collected in order to receive the events.
definition0066,,Requires events from Microsoft-Windows-NTLM/Operational
definition0067,,Requires events from Microsoft-Windows-NTLM/Operational
definition0068,,Requirements: The CAPI2 Operational log needs to be enabled
definition0069,,"Requirements: The ""Microsoft-Windows-TaskScheduler/Operational"" is disabled by default and needs to be enabled in order for this detection to trigger"
definition0070,,"Requirements: The ""Microsoft-Windows-TaskScheduler/Operational"" is disabled by default and needs to be enabled in order for this detection to trigger"
definition0071,,"Requirements: The ""Microsoft-Windows-TaskScheduler/Operational"" is disabled by default and needs to be enabled in order for this detection to trigger"
definition0072,,"WMI Namespaces Auditing and SACL should be configured, EventID 5861 and 5859 detection requires Windows 10, 2012 and higher"
definition0073,,Requirements: Microsoft-Windows-LSA/Operational (199FE037-2B82-40A9-82AC-E1D46C792B99) Event Log must be enabled and collected in order to use this rule.
definition0074,,Requirements:Enabled Block process creations originating from PSExec and WMI commands from Attack Surface Reduction (GUID: d1e49aac-8f56-4280-b9ba-993a6d77406c)
definition0075,,Requirements:Enabled Block credential stealing from the Windows local security authority subsystem (lsass.exe) from Attack Surface Reduction (GUID: 9e6c4e1f-7d60-472f-ba1a-a39ef669e4b2)
definition0076,,"The advanced audit policy setting ""Object Access > Audit Detailed File Share"" must be configured for Success/Failure"
definition0077,,Requirements: Audit Filtering Platform Policy Change needs to be enabled
definition0078,,The 'System Security Extension' audit subcategory need to be enabled to log the EID 4697
definition0079,,"The advanced audit policy setting ""Account Logon > Kerberos Authentication Service"" must be configured for Success/Failure"
definition0080,,The 'System Security Extension' audit subcategory need to be enabled to log the EID 4697
definition0081,,Requirements: Audit Policy : Object Access > Audit Registry (Success)
definition0082,,"Requirements: Audit Policy : Account Management > Audit User Account Management, Group Policy : Computer Configuration\Windows Settings\Security Settings\Advanced Audit Policy Configuration\Audit Policies\Account Management\Audit User Account Management"
definition0083,,"The advanced audit policy setting ""Object Access > Audit Detailed File Share"" must be configured for Success/Failure"
definition0084,,The 'System Security Extension' audit subcategory need to be enabled to log the EID 4697
definition0085,,The 'System Security Extension' audit subcategory need to be enabled to log the EID 4697
definition0086,,"The advanced audit policy setting ""Object Access > Audit Detailed File Share"" must be configured for Success/Failure"
definition0087,,"Requirements: Audit Policy : Account Management > Audit User Account Management, Group Policy : Computer Configuration\Windows Settings\Security Settings\Advanced Audit Policy Configuration\Audit Policies\Account Management\Audit User Account Management, DS Access > Audit Directory Service Changes, Group Policy : Computer Configuration\Windows Settings\Security Settings\Advanced Audit Policy Configuration\Audit Policies\DS Access\Audit Directory Service Changes"
definition0088,,dfd8c0f4-e6ad-4e07-b91b-f2fca0ddef64
definition0089,,The 'System Security Extension' audit subcategory need to be enabled to log the EID 4697
definition0090,,"Requirements: Audit Policy : Security Settings/Local Policies/Audit Policy, Registry System Access Control (SACL): Auditing/User"
definition0091,,The 'System Security Extension' audit subcategory need to be enabled to log the EID 4697
definition0092,,Requirements: The System Security Extension audit subcategory need to be enabled to log the EID 4697
definition0093,,"The advanced audit policy setting ""Object Access > Audit Detailed File Share"" must be configured for Success/Failure"
definition0094,,The 'System Security Extension' audit subcategory need to be enabled to log the EID 4697
definition0095,,"Requirements: Audit Policy : Security Settings/Local Policies/Audit Policy, Registry System Access Control (SACL): Auditing/User"
definition0096,,The Advanced Audit Policy setting Object Access > Audit Other Object Access Events has to be configured to allow this detection. We also recommend extracting the Command field from the embedded XML in the event data.
definition0097,,"Requirements: The ""Audit Directory Service Changes"" logging policy must be configured in order to receive events. Audit events are generated only for objects with configured system access control lists (SACLs). Audit events are generated only for objects with configured system access control lists (SACLs) and only when accessed in a manner that matches their SACL settings. This policy covers the following events ids - 5136, 5137, 5138, 5139, 5141. Note that the default policy does not cover User objects. For that a custom AuditRule need to be setup (See https://github.com/OTRF/Set-AuditRule)"
definition0098,,"The ""Audit Directory Service Changes"" logging policy must be configured in order to receive events. Audit events are generated only for objects with configured system access control lists (SACLs). Audit events are generated only for objects with configured system access control lists (SACLs) and only when accessed in a manner that matches their SACL settings. This policy covers the following events ids - 5136, 5137, 5138, 5139, 5141. Note that the default policy does not cover User objects. For that a custom AuditRule need to be setup (See https://github.com/OTRF/Set-AuditRule)"
definition0099,,Requirements: enable Object Access SAM on your Domain Controllers
definition0100,,"Requirements: The ""Read all properties"" permission on the user object needs to be audited for the ""Everyone"" principal"
definition0101,,"The advanced audit policy setting ""Object Access > Audit Detailed File Share"" must be configured for Success/Failure"
definition0102,,The 'System Security Extension' audit subcategory need to be enabled to log the EID 4697
definition0103,,"The ""Audit Directory Service Changes"" logging policy must be configured in order to receive events. Audit events are generated only for objects with configured system access control lists (SACLs). Audit events are generated only for objects with configured system access control lists (SACLs) and only when accessed in a manner that matches their SACL settings. This policy covers the following events ids - 5136, 5137, 5138, 5139, 5141. Note that the default policy does not cover User objects. For that a custom AuditRule need to be setup (See https://github.com/OTRF/Set-AuditRule)"
definition0104,,The 'System Security Extension' audit subcategory need to be enabled to log the EID 4697
definition0105,,The 'System Security Extension' audit subcategory need to be enabled to log the EID 4697
definition0106,,"The advanced audit policy setting ""Object Access > Detailed File Share"" must be configured for Success/Failure"
definition0107,,The 'System Security Extension' audit subcategory need to be enabled to log the EID 4697
definition0108,,The Advanced Audit Policy setting Object Access > Audit Other Object Access Events has to be configured to allow this detection. We also recommend extracting the Command field from the embedded XML in the event data.
definition0109,,The 'System Security Extension' audit subcategory need to be enabled to log the EID 4697
definition0110,,The 'System Security Extension' audit subcategory need to be enabled to log the EID 4697
definition0111,,dfd8c0f4-e6ad-4e07-b91b-f2fca0ddef64
definition0112,,"The advanced audit policy setting ""Object Access > Audit Detailed File Share"" must be configured for Success/Failure"
definition0113,,"The advanced audit policy setting ""Object Access > Audit Detailed File Share"" must be configured for Success/Failure"
definition0114,,"Requirements: Audit Policy : Policy Change > Audit Authorization Policy Change, Group Policy : Computer Configuration\Windows Settings\Security Settings\Advanced Audit Policy Configuration\Audit Policies\Policy Change\Audit Authorization Policy Change"
definition0115,,"The advanced audit policy setting ""Object Access > Audit Removable Storage"" must be configured for Success/Failure"
definition0116,,"The ""Audit Directory Service Changes"" logging policy must be configured in order to receive events. Audit events are generated only for objects with configured system access control lists (SACLs). Audit events are generated only for objects with configured system access control lists (SACLs) and only when accessed in a manner that matches their SACL settings. This policy covers the following events ids - 5136, 5137, 5138, 5139, 5141. Note that the default policy does not cover User objects. For that a custom AuditRule need to be setup (See https://github.com/OTRF/Set-AuditRule)"
definition0117,,"Requirements: The ""Audit Directory Service Changes"" logging policy must be configured in order to receive events."
definition0118,,Certificate services loaded a template would trigger event ID 4898 and certificate Services template was updated would trigger event ID 4899. A risk permission seems to be coming if template contain specific flag with risky EKU.
definition0119,,The 'System Security Extension' audit subcategory need to be enabled to log the EID 4697
definition0120,,"By default these events are not logged by default for MicrosoftDNS objects in Active Directory.
To enable detection, configure an AuditRule on the DNS object container with the ""CreateChild"" permission for the ""Everyone"" principal.
This can be accomplished using tools such as Set-AuditRule (see https://github.com/OTRF/Set-AuditRule).
"
definition0121,,The 'System Security Extension' audit subcategory need to be enabled to log the EID 4697
definition0122,,The Advanced Audit Policy setting Object Access > Audit Other Object Access Events has to be configured to allow this detection. We also recommend extracting the Command field from the embedded XML in the event data.
definition0123,,The 'System Security Extension' audit subcategory need to be enabled to log the EID 4697
definition0124,,"The advanced audit policy setting ""Object Access > Audit Detailed File Share"" must be configured for Success/Failure"
definition0125,,Requirements: Audit Filtering Platform Policy Change needs to be enabled
definition0126,,The 'System Security Extension' audit subcategory need to be enabled to log the EID 4697
definition0127,,The 'System Security Extension' audit subcategory need to be enabled to log the EID 4697
definition0128,,The 'System Security Extension' audit subcategory need to be enabled to log the EID 4697
definition0129,,"The volume of Event ID 4661 is high on Domain Controllers and therefore ""Audit SAM"" and ""Audit Kernel Object"" advanced audit policy settings are not configured in the recommendations for server systems"
definition0130,,Requirements: Audit Filtering Platform Connection needs to be enabled
definition0131,,The successful use of PtH for lateral movement between workstations would trigger event ID 4624
definition0132,,"Note that you have to configure logging for Named Pipe Events in Sysmon config (Event ID 17 and Event ID 18). The basic configuration is in popular sysmon configuration (https://github.com/SwiftOnSecurity/sysmon-config), but it is worth verifying. You can also use other repo, e.g. https://github.com/Neo23x0/sysmon-config, https://github.com/olafhartong/sysmon-modular You can also use other repo, e.g. https://github.com/Neo23x0/sysmon-config, https://github.com/olafhartong/sysmon-modular. How to test detection? You can always use Cobalt Strike, but also you can check powershell script from this site https://svch0st.medium.com/guide-to-named-pipes-and-hunting-for-cobalt-strike-pipes-dc46b2c5f575"
definition0133,,"Note that you have to configure logging for Named Pipe Events in Sysmon config (Event ID 17 and Event ID 18). The basic configuration is in popular sysmon configuration (https://github.com/SwiftOnSecurity/sysmon-config), but it is worth verifying. You can also use other repo, e.g. https://github.com/Neo23x0/sysmon-config, https://github.com/olafhartong/sysmon-modular. How to test detection? You can check powershell script from this site https://svch0st.medium.com/guide-to-named-pipes-and-hunting-for-cobalt-strike-pipes-dc46b2c5f575"
definition0134,,"Note that you have to configure logging for Named Pipe Events in Sysmon config (Event ID 17 and Event ID 18). The basic configuration is in popular sysmon configuration (https://github.com/SwiftOnSecurity/sysmon-config), but it is worth verifying. You can also use other repo, e.g. https://github.com/Neo23x0/sysmon-config, https://github.com/olafhartong/sysmon-modular. How to test detection? You can check powershell script from this site https://svch0st.medium.com/guide-to-named-pipes-and-hunting-for-cobalt-strike-pipes-dc46b2c5f575"
definition0135,,"Note that you have to configure logging for Named Pipe Events in Sysmon config (Event ID 17 and Event ID 18). The basic configuration is in popular sysmon configuration (https://github.com/SwiftOnSecurity/sysmon-config), but it is worth verifying. You can also use other repo, e.g. https://github.com/Neo23x0/sysmon-config, https://github.com/olafhartong/sysmon-modular. How to test detection? You can check powershell script from this site https://svch0st.medium.com/guide-to-named-pipes-and-hunting-for-cobalt-strike-pipes-dc46b2c5f575"
definition0136,,"Note that you have to configure logging for Named Pipe Events in Sysmon config (Event ID 17 and Event ID 18). The basic configuration is in popular sysmon configuration (https://github.com/SwiftOnSecurity/sysmon-config), but it is worth verifying. You can also use other repo, e.g. https://github.com/Neo23x0/sysmon-config, https://github.com/olafhartong/sysmon-modular You can also use other repo, e.g. https://github.com/Neo23x0/sysmon-config, https://github.com/olafhartong/sysmon-modular. How to test detection? You can always use Cobalt Strike, but also you can check powershell script from this site https://svch0st.medium.com/guide-to-named-pipes-and-hunting-for-cobalt-strike-pipes-dc46b2c5f575"
definition0137,,"Note that you have to configure logging for Named Pipe Events in Sysmon config (Event ID 17 and Event ID 18). The basic configuration is in popular sysmon configuration (https://github.com/SwiftOnSecurity/sysmon-config), but it is worth verifying. You can also use other repo, e.g. https://github.com/Neo23x0/sysmon-config, https://github.com/olafhartong/sysmon-modular. How to test detection? You can check powershell script from this site https://svch0st.medium.com/guide-to-named-pipes-and-hunting-for-cobalt-strike-pipes-dc46b2c5f575"
definition0138,,"Note that you have to configure logging for Named Pipe Events in Sysmon config (Event ID 17 and Event ID 18). The basic configuration is in popular sysmon configuration (https://github.com/SwiftOnSecurity/sysmon-config), but it is worth verifying. You can also use other repo, e.g. https://github.com/Neo23x0/sysmon-config, https://github.com/olafhartong/sysmon-modular. How to test detection? You can check powershell script from this site https://svch0st.medium.com/guide-to-named-pipes-and-hunting-for-cobalt-strike-pipes-dc46b2c5f575"
definition0139,,"Note that you have to configure logging for Named Pipe Events in Sysmon config (Event ID 17 and Event ID 18). The basic configuration is in popular sysmon configuration (https://github.com/SwiftOnSecurity/sysmon-config), but it is worth verifying. You can also use other repo, e.g. https://github.com/Neo23x0/sysmon-config, https://github.com/olafhartong/sysmon-modular. How to test detection? You can check powershell script from this site https://svch0st.medium.com/guide-to-named-pipes-and-hunting-for-cobalt-strike-pipes-dc46b2c5f575"
definition0140,,"Note that you have to configure logging for Named Pipe Events in Sysmon config (Event ID 17 and Event ID 18). The basic configuration is in popular sysmon configuration (https://github.com/SwiftOnSecurity/sysmon-config), but it is worth verifying. You can also use other repo, e.g. https://github.com/Neo23x0/sysmon-config, https://github.com/olafhartong/sysmon-modular. How to test detection? You can check powershell script from this site https://svch0st.medium.com/guide-to-named-pipes-and-hunting-for-cobalt-strike-pipes-dc46b2c5f575"
definition0141,,"Note that you have to configure logging for Named Pipe Events in Sysmon config (Event ID 17 and Event ID 18). The basic configuration is in popular sysmon configuration (https://github.com/SwiftOnSecurity/sysmon-config), but it is worth verifying. You can also use other repo, e.g. https://github.com/Neo23x0/sysmon-config, https://github.com/olafhartong/sysmon-modular. How to test detection? You can check powershell script from this site https://svch0st.medium.com/guide-to-named-pipes-and-hunting-for-cobalt-strike-pipes-dc46b2c5f575"
definition0142,,"Note that you have to configure logging for Named Pipe Events in Sysmon config (Event ID 17 and Event ID 18). The basic configuration is in popular sysmon configuration (https://github.com/SwiftOnSecurity/sysmon-config), but it is worth verifying. You can also use other repo, e.g. https://github.com/Neo23x0/sysmon-config, https://github.com/olafhartong/sysmon-modular. How to test detection? You can check powershell script from this site https://svch0st.medium.com/guide-to-named-pipes-and-hunting-for-cobalt-strike-pipes-dc46b2c5f575"
definition0143,,"Note that you have to configure logging for Named Pipe Events in Sysmon config (Event ID 17 and Event ID 18). The basic configuration is in popular sysmon configuration (https://github.com/SwiftOnSecurity/sysmon-config), but it is worth verifying. You can also use other repo, e.g. https://github.com/Neo23x0/sysmon-config, https://github.com/olafhartong/sysmon-modular. How to test detection? You can check powershell script from this site https://svch0st.medium.com/guide-to-named-pipes-and-hunting-for-cobalt-strike-pipes-dc46b2c5f575"
definition0144,,"Note that you have to configure logging for Named Pipe Events in Sysmon config (Event ID 17 and Event ID 18). The basic configuration is in popular sysmon configuration (https://github.com/SwiftOnSecurity/sysmon-config), but it is worth verifying. You can also use other repo, e.g. https://github.com/Neo23x0/sysmon-config, https://github.com/olafhartong/sysmon-modular. How to test detection? You can check powershell script from this site https://svch0st.medium.com/guide-to-named-pipes-and-hunting-for-cobalt-strike-pipes-dc46b2c5f575"
definition0145,,"Note that you have to configure logging for Named Pipe Events in Sysmon config (Event ID 17 and Event ID 18). The basic configuration is in popular sysmon configuration (https://github.com/SwiftOnSecurity/sysmon-config), but it is worth verifying. You can also use other repo, e.g. https://github.com/Neo23x0/sysmon-config, https://github.com/olafhartong/sysmon-modular. How to test detection? You can check powershell script from this site https://svch0st.medium.com/guide-to-named-pipes-and-hunting-for-cobalt-strike-pipes-dc46b2c5f575"
definition0146,,"Note that you have to configure logging for Named Pipe Events in Sysmon config (Event ID 17 and Event ID 18). The basic configuration is in popular sysmon configuration (https://github.com/SwiftOnSecurity/sysmon-config), but it is worth verifying. You can also use other repo, e.g. https://github.com/Neo23x0/sysmon-config, https://github.com/olafhartong/sysmon-modular. How to test detection? You can check powershell script from this site https://svch0st.medium.com/guide-to-named-pipes-and-hunting-for-cobalt-strike-pipes-dc46b2c5f575"
definition0147,,"Note that you have to configure logging for Named Pipe Events in Sysmon config (Event ID 17 and Event ID 18). The basic configuration is in popular sysmon configuration (https://github.com/SwiftOnSecurity/sysmon-config), but it is worth verifying. You can also use other repo, e.g. https://github.com/Neo23x0/sysmon-config, https://github.com/olafhartong/sysmon-modular. How to test detection? You can always use Cobalt Strike, but also you can check powershell script from this site https://svch0st.medium.com/guide-to-named-pipes-and-hunting-for-cobalt-strike-pipes-dc46b2c5f575"
definition0148,,Requirements: Microsoft-Windows-Kernel-File ETW provider
definition0149,,Requirements: Microsoft-Windows-Kernel-File ETW provider
definition0150,,Requirements: Microsoft-Windows-Kernel-File ETW provider
definition0151,,Requirements: Microsoft-Windows-Kernel-File ETW provider
definition0152,,Requirements: Microsoft-Windows-Kernel-File ETW provider
definition0153,,Requirements: Microsoft-Windows-Kernel-File ETW provider
definition0154,,"Requirements: The ""ParentImage"" field is not available by default on EID 11 of Sysmon logs. To be able to use this rule to the full extent you need to enrich the log with additional ParentImage data"
definition0155,,"Requirements: The "".evtx"" extension should be monitored via a Sysmon configuration. Example: <TargetFilename condition=""end with"">.evtx<TargetFilename>"
definition0156,,Requirements: UsageLogs folder must be monitored by the sysmon configuration
definition0157,,"Requirements: The ""ParentImage"" field is not available by default on EID 11 of Sysmon logs. To be able to use this rule to the full extent you need to enriche the log with additional ParentImage data"
definition0158,,Requirements: Microsoft-Windows-Kernel-File Provider with at least the KERNEL_FILE_KEYWORD_RENAME_SETLINK_PATH keyword
definition0159,,"Since options '-d' and '-p' were removed in Windows 10 this rule is relevant only for Windows before 10. And as Windows 7 doesn't log command line in 4688 by default, to detect this attack you need Sysmon 1 configured or KB3004375 installed for command-line auditing (https://support.microsoft.com/en-au/help/3004375/microsoft-security-advisory-update-to-improve-windows-command-line-aud)"
definition0160,,Requirements: ParentUser field needs sysmon >= 13.30
definition0161,,"Requirements: The registry key ""\SOFTWARE\Microsoft\Provisioning\Commands\"" and its subkey must be monitored"
definition0162,,Requirements: Sysmon config that monitors \Keyboard Layout\Preload subkey of the HKLU hives - see https://github.com/SwiftOnSecurity/sysmon-config/pull/92/files
definition0163,,Requirements: Sysmon config that monitors \SOFTWARE\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\TelemetryController subkey of the HKLM hives
definition0164,,Requirements: Script Block Logging must be enabled
definition0165,,Requirements: Script Block Logging must be enabled
definition0166,,Requirements: Script Block Logging must be enabled
definition0167,,Requirements: Script Block Logging must be enabled
definition0168,,Requirements: Script Block Logging must be enabled
definition0169,,bade5735-5ab0-4aa7-a642-a11be0e40872
definition0170,,Requirements: Script Block Logging must be enabled
definition0171,,Requirements: Script Block Logging must be enabled
definition0172,,Requirements: Script Block Logging must be enabled
definition0173,,Requirements: Script Block Logging must be enabled
definition0174,,Requirements: Script Block Logging must be enabled
definition0175,,Requirements: Script Block Logging must be enabled
definition0176,,Requirements: Script Block Logging must be enabled
definition0177,,Requirements: Script Block Logging must be enabled
definition0178,,Requirements: Script Block Logging must be enabled
definition0179,,Requirements: Script Block Logging must be enabled
definition0180,,Requirements: Script Block Logging must be enabled
definition0181,,Requirements: Script Block Logging must be enabled
definition0182,,Requirements: Script Block Logging must be enabled
definition0183,,Requirements: Script Block Logging must be enabled
definition0184,,Requirements: Script Block Logging must be enabled
definition0185,,Requirements: Script Block Logging must be enabled
definition0186,,Requirements: Script Block Logging must be enabled
definition0187,,Requirements: Script Block Logging must be enabled
definition0188,,Requirements: Script Block Logging must be enabled
definition0189,,Requirements: Script Block Logging must be enabled
definition0190,,Requirements: Script Block Logging must be enabled
definition0191,,Requirements: Script Block Logging must be enabled
definition0192,,Requirements: Script Block Logging must be enabled
definition0193,,Requirements: Script Block Logging must be enabled
definition0194,,Requirements: Script Block Logging must be enabled
definition0195,,Requirements: Script Block Logging must be enabled
definition0196,,Requirements: Script Block Logging must be enabled
definition0197,,Requirements: Script Block Logging must be enabled
definition0198,,Requirements: Script Block Logging must be enabled
definition0199,,Requirements: Script Block Logging must be enabled
definition0200,,Script Block Logging must be enable
definition0201,,Requirements: Script Block Logging must be enabled
definition0202,,Requirements: Script Block Logging must be enabled
definition0203,,Requirements: Script Block Logging must be enabled
definition0204,,Requirements: Script Block Logging must be enable
definition0205,,Requirements: Script Block Logging must be enabled
definition0206,,Requirements: Script Block Logging must be enabled
definition0207,,Requirements: Script Block Logging must be enabled
definition0208,,Requirements: Script Block Logging must be enabled
definition0209,,Requirements: Script Block Logging must be enabled
definition0210,,Requirements: Script Block Logging must be enabled
definition0211,,Requirements: Script Block Logging must be enabled
definition0212,,Requirements: Script Block Logging must be enabled
definition0213,,bade5735-5ab0-4aa7-a642-a11be0e40872
definition0214,,Script Block Logging must be enable
definition0215,,Requirements: Script Block Logging must be enabled
definition0216,,Requirements: Script Block Logging must be enabled
definition0217,,Requirements: Script Block Logging must be enabled
definition0218,,Requirements: Script Block Logging must be enabled
definition0219,,Requirements: Script Block Logging must be enabled
definition0220,,Requirements: Script Block Logging must be enabled
definition0221,,Requirements: Script Block Logging must be enabled
definition0222,,Requirements: Script Block Logging must be enabled
definition0223,,Requirements: Script Block Logging must be enabled
definition0224,,Requirements: Script Block Logging must be enabled
definition0225,,Requirements: Script Block Logging must be enabled
definition0226,,Requirements: Script Block Logging must be enabled
definition0227,,Requirements: Script Block Logging must be enable
definition0228,,Requirements: Script Block Logging must be enabled
definition0229,,Requirements: Script Block Logging must be enabled
definition0230,,Requirements: Script Block Logging must be enabled
definition0231,,Requirements: Script Block Logging must be enabled
definition0232,,Requirements: Script Block Logging must be enabled
definition0233,,Requirements: Script Block Logging must be enabled
definition0234,,Requirements: Script Block Logging must be enabled
definition0235,,Requirements: Script Block Logging must be enabled
definition0236,,Requirements: Script Block Logging must be enabled
definition0237,,Requirements: Script Block Logging must be enabled
definition0238,,Requirements: Script Block Logging must be enabled
definition0239,,Requirements: Script Block Logging must be enabled
definition0240,,Requirements: Script Block Logging must be enabled
definition0241,,Requirements: Script Block Logging must be enabled
definition0242,,Requirements: Script Block Logging must be enabled
definition0243,,Requirements: Script Block Logging must be enabled
definition0244,,bade5735-5ab0-4aa7-a642-a11be0e40872
definition0245,,Requirements: Script Block Logging must be enabled
definition0246,,Requirements: Script Block Logging must be enabled
definition0247,,Script Block Logging must be enable
definition0248,,Requirements: Script Block Logging must be enabled
definition0249,,Requirements: Script Block Logging must be enabled
definition0250,,Script Block Logging must be enable
definition0251,,Requirements: Script Block Logging must be enabled
definition0252,,Requirements: Script Block Logging must be enabled
definition0253,,bade5735-5ab0-4aa7-a642-a11be0e40872
definition0254,,Requirements: Script Block Logging must be enabled
definition0255,,Requirements: Script Block Logging must be enabled
definition0256,,Requirements: Script Block Logging must be enabled
definition0257,,Requirements: Script Block Logging must be enabled
definition0258,,Requirements: Script Block Logging must be enabled
definition0259,,Requirements: Script Block Logging must be enabled
definition0260,,Requirements: Script Block Logging must be enabled
definition0261,,Requirements: Script Block Logging must be enabled
definition0262,,Requirements: Script Block Logging must be enabled
definition0263,,Requirements: Script Block Logging must be enabled
definition0264,,Requirements: Script Block Logging must be enabled
definition0265,,Requirements: Script Block Logging must be enabled
definition0266,,Requirements: Script Block Logging must be enabled
definition0267,,Requirements: Script Block Logging must be enabled
definition0268,,Requirements: Script Block Logging must be enabled
definition0269,,Requirements: Script Block Logging must be enabled
definition0270,,Requirements: Script Block Logging must be enabled
definition0271,,bade5735-5ab0-4aa7-a642-a11be0e40872
definition0272,,Requirements: Script Block Logging must be enabled
definition0273,,Requirements: Script Block Logging must be enabled
definition0274,,Requirements: Script Block Logging must be enabled
definition0275,,Requirements: Script Block Logging must be enabled
definition0276,,Requirements: Script Block Logging must be enabled
definition0277,,Requirements: Script Block Logging must be enabled
definition0278,,Requirements: Script Block Logging must be enabled
definition0279,,Requirements: Script Block Logging must be enabled
definition0280,,Requirements: Script Block Logging must be enabled
definition0281,,Requirements: Script Block Logging must be enabled
definition0282,,Requirements: Script Block Logging must be enabled
definition0283,,Requirements: Script Block Logging must be enabled
definition0284,,Requirements: Script Block Logging must be enabled
definition0285,,Requirements: Script Block Logging must be enabled
definition0286,,Requirements: Script Block Logging must be enabled
definition0287,,Requirements: Script Block Logging must be enabled
definition0288,,Requirements: Script Block Logging must be enabled
definition0289,,Requirements: Script Block Logging must be enabled
definition0290,,Requirements: Script Block Logging must be enabled
definition0291,,Requirements: Script Block Logging must be enabled
definition0292,,Requirements: Script Block Logging must be enabled
definition0293,,Requirements: Script Block Logging must be enabled
definition0294,,Requirements: Script Block Logging must be enabled
definition0295,,Requirements: Script Block Logging must be enabled
definition0296,,Requirements: Script Block Logging must be enabled
definition0297,,Requirements: Script Block Logging must be enabled
definition0298,,Requirements: Script Block Logging must be enabled
definition0299,,Requirements: Script Block Logging must be enabled
definition0300,,Requirements: Script Block Logging must be enabled
definition0301,,Requirements: Script Block Logging must be enabled
definition0302,,Requirements: Script Block Logging must be enabled
definition0303,,Requirements: Script Block Logging must be enabled
definition0304,,0ad03ef1-f21b-4a79-8ce8-e6900c54b65b
definition0305,,0ad03ef1-f21b-4a79-8ce8-e6900c54b65b
definition0306,,0ad03ef1-f21b-4a79-8ce8-e6900c54b65b
definition0307,,0ad03ef1-f21b-4a79-8ce8-e6900c54b65b
definition0308,,0ad03ef1-f21b-4a79-8ce8-e6900c54b65b
definition0309,,0ad03ef1-f21b-4a79-8ce8-e6900c54b65b
definition0310,,0ad03ef1-f21b-4a79-8ce8-e6900c54b65b
definition0311,,0ad03ef1-f21b-4a79-8ce8-e6900c54b65b
definition0312,,0ad03ef1-f21b-4a79-8ce8-e6900c54b65b
definition0313,,0ad03ef1-f21b-4a79-8ce8-e6900c54b65b
definition0314,,0ad03ef1-f21b-4a79-8ce8-e6900c54b65b
definition0315,,0ad03ef1-f21b-4a79-8ce8-e6900c54b65b
definition0316,,0ad03ef1-f21b-4a79-8ce8-e6900c54b65b
definition0317,,0ad03ef1-f21b-4a79-8ce8-e6900c54b65b
definition0318,,0ad03ef1-f21b-4a79-8ce8-e6900c54b65b
definition0319,,0ad03ef1-f21b-4a79-8ce8-e6900c54b65b
definition0320,,0ad03ef1-f21b-4a79-8ce8-e6900c54b65b
definition0321,,0ad03ef1-f21b-4a79-8ce8-e6900c54b65b
definition0322,,0ad03ef1-f21b-4a79-8ce8-e6900c54b65b
definition0323,,0ad03ef1-f21b-4a79-8ce8-e6900c54b65b
definition0324,,0ad03ef1-f21b-4a79-8ce8-e6900c54b65b
definition0325,,0ad03ef1-f21b-4a79-8ce8-e6900c54b65b
definition0326,,0ad03ef1-f21b-4a79-8ce8-e6900c54b65b
definition0327,,0ad03ef1-f21b-4a79-8ce8-e6900c54b65b
definition0328,,0ad03ef1-f21b-4a79-8ce8-e6900c54b65b
definition0329,,0ad03ef1-f21b-4a79-8ce8-e6900c54b65b
definition0330,,0ad03ef1-f21b-4a79-8ce8-e6900c54b65b
definition0331,,fields have to be extract from event
definition0332,,"Enable the builtin Zeek script that logs all HTTP header names by adding ""@load policy/protocols/http/header-names"" to your local.zeek config file. The script can be seen here for reference https://github.com/zeek/zeek/blob/d957f883df242ef159cfd846884e673addeea7a5/scripts/policy/protocols/http/header-names.zeek"
definition0333,,"Required auditd configuration:
-a always,exit -F arch=b64 -S syslog -F a0=4 -k clear_dmesg_logs
-a always,exit -F arch=b64 -S syslog -F a0=5 -k clear_dmesg_logs
-a always,exit -F arch=b64 -S syslog -F a0=6 -k disable_dmesg_logs
-a always,exit -F arch=b32 -S syslog -F a0=4 -k clear_dmesg_logs
-a always,exit -F arch=b32 -S syslog -F a0=5 -k clear_dmesg_logs
-a always,exit -F arch=b32 -S syslog -F a0=6 -k disable_dmesg_logs
"
definition0334,,"Required auditd configuration:
-w /proc/sysrq-trigger -p wa -k sysrq
-w /proc/sys/kernel/sysrq -p wa -k sysrq
"
definition0335,,"Required auditd configuration:
-a always,exit -F arch=b32 -S execve -F euid=33 -k detect_execve_www
-a always,exit -F arch=b64 -S execve -F euid=33 -k detect_execve_www
-a always,exit -F arch=b32 -S execveat -F euid=33 -k detect_execve_www
-a always,exit -F arch=b64 -S execveat -F euid=33 -k detect_execve_www
Change the number ""33"" to the ID of your WebServer user. Default: www-data:x:33:33
"
definition0336,,/var/log/secure on REHL systems or /var/log/auth.log on debian like Systems needs to be collected in order for this detection to work
definition0337,,Requirements: Must be able to collect the error.log file
definition0338,,Requirements: Must be able to collect the error.log file
definition0339,,Requirements: Must be able to log the SQL queries
definition0340,,Requirements: SACLs must be enabled for the ScreenConnect directory
definition0341,,Requirements: file creation events need to be ingested from the Palo Alto GlobalProtect appliance
definition0342,,"Requirements: Palo Alto GlobalProtect ""mp-log"" and ""gpsvc.log"" log files need to be ingested"
definition0343,,Requirements: SACLs must be enabled for the ScreenConnect directory
definition0344,,Requirements: The Advanced Audit Policy setting Object Access > Audit Other Object Access Events has to be configured to trigger this detection.
definition0345,,Requirements: Microsoft-Windows-DNS-Server/Analytical ({EB79061A-A566-4698-9119-3ED2807060E7}) Event Log must be collected in order to receive the events.
definition0346,,Requirements: Audit Policy : Audit Other Object Access Events > Success
definition0347,,"Make sure that your Netscaler appliance logs all kinds of attacks (test with http://your-citrix-gw.net/robots.txt). The directory traversal with ../ might not be needed on certain cloud instances or for authenticated users, so we also check for direct paths. All scripts in portal/scripts are exploitable except logout.pl."
definition0348,,The 'System Security Extension' audit subcategory need to be enabled to log the EID 4697
definition0349,,"Requirements: In order for this detection to trigger, access logs of the router must be collected."
definition0350,,"Requirements: SACLs must be enabled for ""Query Value"" on the registry keys used in this rule"
definition0351,,Requirements: Cisco IOS XE system logs needs to be configured and ingested
definition0352,,Requirements: The POST request body data must be collected in order to make use of this detection
definition0353,,Requirements: The POST request body data must be collected in order to make use of this detection
definition0354,,"The advanced audit policy setting ""Object Access > Audit File Share"" must be configured for Success/Failure"
definition0355,,bade5735-5ab0-4aa7-a642-a11be0e40872
definition0356,,bade5735-5ab0-4aa7-a642-a11be0e40872
definition0357,,"Requirements: The ""Microsoft-Windows-TaskScheduler/Operational"" is disabled by default and needs to be enabled in order for this detection to trigger"
definition0358,,The Advanced Audit Policy setting Object Access > Audit Other Object Access Events has to be configured to allow this detection. We also recommend extracting the Command field from the embedded XML in the event data.
definition0359,,Requirements: Script Block Logging must be enabled
definition0360,,Requirements: Script Block Logging must be enabled
definition0361,,Requirements: By default the process_creation type event might not contain the GrandParentImage. Make sure you collect such fields in order to use this rule
definition0362,,Requirements: By default the network_connection type event might not contain the ParentImage. Make sure you collect such fields in order to use this rule
definition0363,,"Note that you have to configure logging for Named Pipe Events in Sysmon config (Event ID 17 and Event ID 18). The basic configuration is in popular sysmon configuration (https://github.com/SwiftOnSecurity/sysmon-config), but it is worth verifying. You can also use other repo, e.g. https://github.com/Neo23x0/sysmon-config, https://github.com/olafhartong/sysmon-modular. How to test detection? You can check powershell script from this site https://svch0st.medium.com/guide-to-named-pipes-and-hunting-for-cobalt-strike-pipes-dc46b2c5f575"
definition0364,,The 'System Security Extension' audit subcategory need to be enabled to log the EID 4697
definition0365,,"Requirements: The following config is required to generate the necessary Event ID 10 Process Access events: <ProcessAccess onmatch=""include""><CallTrace condition=""contains"">VBE7.DLL</CallTrace></ProcessAccess><ProcessAccess onmatch=""exclude""><CallTrace condition=""excludes"">UNKNOWN</CallTrace></ProcessAccess>"
definition0366,,Requirements: file creation events or equivalent must be collected from the FortiOS SSL-VPN appliance in order for this detection to function correctly
definition0367,,Must be collect log from \ManageEngine\ADSelfService Plus\logs
definition0368,,Requirements: The POST request body data must be collected in order to make use of this detection
definition0369,,Requirements: The POST request body data must be collected in order to make use of certain parts of this detection
